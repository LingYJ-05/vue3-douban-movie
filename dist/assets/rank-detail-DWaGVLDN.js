import{_ as O,r as a,s as $,n as H,c as w,o as v,a as r,p as _,e as S,t as Y,F as q,d as x,x as G,u as J,y as K,b as P,v as Q,j as U,z as W,f as X,L as Z,k as ee,A as ae}from"./index-DLCzzkkd.js";import{S as se}from"./switches-BRLQLFHU.js";import{R as T}from"./rank-list-DdeAIle8.js";import{c as k}from"./movieList-BjU62QpE.js";import{u as le,n as te,w as oe,t as ne}from"./movie-rank-BeDjeHwM.js";const ue={class:"rank-wrapper"},re={class:"fixed-title"},ce={class:"type"},m=10,ve={__name:"rank-detail",setup(pe){const R=G(),d=J(),g=K(),t=a(""),o=a(null),n=a(0),M=a(!0),I=a(!0),E=a(3),F=a(!0),h=a([{name:"1-50"},{name:"51-100"},{name:"101-150"},{name:"151-200"},{name:"201-250"}]),L=a(!0),p=a([0,50,100,150,200]),b=a([0,0,0,0,0]),l=a({}),c=a([!1,!1,!1,!1,!1]),i=a(!0),f=a(null),j=()=>{d.back("/rank")},B=e=>{b.value[n.value]=e.y},C=e=>{n.value=e,i.value=!0,ae(()=>{f.value&&f.value.length>0&&f.value.forEach(s=>{s.scrollTo(0,b.value[e]),setTimeout(()=>{s.refresh()},20)}),(!l.value[e]||l.value[e]&&l.value[e].length===0)&&(c.value[e]=!0,o.value(p.value[e],m).then(s=>{l.value[e]=k(s.subjects)}))})},V=e=>{d.push(`/movie/${e.id}`),g.commit("SET_MOVIE",e)},D=()=>{const e=n.value;i.value&&(i.value=!1,c.value[e]&&(p.value[e]+=m,o.value(p.value[e],m).then(s=>{l.value[e]=l.value[e].concat(k(s.subjects)),N(s),i.value=!0})))},N=e=>{const s=e.subjects,y=50*(n.value+1);(!s.length||e.start+e.count>=y)&&(c.value[n.value]=!1)},z=()=>{switch(R.params.rankType){case"top250":o.value=ne,t.value="豆瓣 Top250";break;case"weekly":o.value=oe,t.value="本周口碑榜";break;case"new":o.value=te,t.value="新片榜";break;case"us":o.value=le,t.value="北美票房榜";break}},A=()=>{t.value!=="豆瓣 Top250"?o.value().then(e=>{l.value[0]=k(e.subjects)}):o.value(p.value[0],m).then(e=>{l.value[0]=k(e.subjects),c.value[0]=!0})};return $(()=>{for(let e=0;e<h.value.length;e++)l.value[e]=[]}),H(()=>{z(),A()}),(e,s)=>(v(),w("div",ue,[r("div",re,[r("span",{class:"back",onClick:j},[...s[0]||(s[0]=[r("i",{class:"icon-back"},"←",-1)])]),r("span",ce,[r("span",null,Y(t.value),1)])]),t.value==="豆瓣 Top250"?(v(),_(se,{key:0,switches:h.value,currentIndex:n.value,smallFont:L.value,onSwitch:C},null,8,["switches","currentIndex","smallFont"])):S("",!0),(v(!0),w(q,null,x(h.value,(y,u)=>P((v(),_(ee,{data:T[u],pullup:I.value,key:u,probeType:E.value,listenScroll:F.value,onScrollToEnd:D,onScroll:B,class:"rank-list-wrapper",ref_for:!0,ref_key:"scrollRef",ref:f},{default:U(()=>[r("div",{class:W(["rank-content",{"more-padding":t.value==="豆瓣 Top250"}])},[X(T,{rankItems:l.value[u],hasMore:c.value,page:u,onSelect:V},null,8,["rankItems","hasMore","page"])],2),l.value[u].length?S("",!0):(v(),_(Z,{key:0,fullScreen:M.value},null,8,["fullScreen"]))]),_:2},1032,["data","pullup","probeType","listenScroll"])),[[Q,n.value===u]])),128))]))}},_e=O(ve,[["__scopeId","data-v-a2b76df4"]]);export{_e as default};
