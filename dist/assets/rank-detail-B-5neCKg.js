import{r as t,c as N,j as B,a as V,o as y,e as r,i as S,b as g,g as I,p as j,t as T,m as z,B as D,u as F,n as $}from"./vue-CHuA8iFr.js";import{c as U}from"./movieList-BjU62QpE.js";import{m as W,c as q,d as A,e as G,_ as H,S as J,b as K,L as Q}from"./movie-components-DFiMdlGe.js";import{R as X}from"./rank-list-ComxCa6W.js";import"./vendor-ngrFHoWO.js";function Y(i,c){return Promise.resolve(G)}function Z(i,c){return Promise.resolve(A)}function ee(i,c){return Promise.resolve(q)}function ae(i,c){return Promise.resolve(W)}const te={class:"rank-wrapper"},se={class:"fixed-title"},ne={class:"type"},oe={style:{color:"red","text-align":"center","font-size":"12px"}},le={__name:"rank-detail",setup(i){const c=D(),h=j(),v=F(),k=t(""),R=t(null),s=t(!1),l=t(0),L=t([{name:"1-50"},{name:"51-100"},{name:"101-150"},{name:"151-200"},{name:"201-250"}]),n=t([]),p=t(!0),d=t(!1);t(0);const u=t(null),m=N(()=>s.value?n.value[l.value]||[]:n.value[0]||[]),M=()=>h.back("/rank"),b=e=>{e>0&&v.commit("SET_SCROLL_POSITION",e),e===0&&(e=v.state.scrollPosition||0),u.value&&u.value.scrollTo(0,e,300),v.commit("SET_SCROLL_POSITION",e)},C=e=>{l.value=e,n.value[e]||_(e*50,50,e),nextTick(()=>{u.value&&u.value.refresh()})},O=e=>{h.push(`/movie/${e.id}`),v.commit("SET_MOVIE",e)},P=async()=>{var o;if(d.value||!p.value)return;d.value=!0;const e=s.value?l.value*50+m.value.length:((o=n.value[0])==null?void 0:o.length)||0;try{await _(e,10,l.value)}finally{d.value=!1}},_=async(e,o,a)=>{const f=await R.value(e,o),w=U(f.subjects);n.value[a]||(n.value[a]=[]),e===0||!s.value?n.value[a]=w:n.value[a]=[...n.value[a],...w],p.value=f.subjects.length===o&&f.start+f.count<(s.value?50:100)},x=()=>{const e=c.params.rankType,a={top250:{fn:Y,name:"豆瓣 Top250",isTop250:!0},weekly:{fn:Z,name:"本周口碑榜",isTop250:!1},new:{fn:ee,name:"新片榜",isTop250:!1},us:{fn:ae,name:"北美票房榜",isTop250:!1}}[e];a&&(R.value=a.fn,k.value=a.name,s.value=a.isTop250)},E=async()=>{await _(0,s.value?50:100,l.value)};return B(()=>{x(),E()}),(e,o)=>(y(),V("div",te,[r("div",se,[r("span",{class:"back",onClick:M},[...o[0]||(o[0]=[r("i",{class:"icon-back"},"←",-1)])]),r("span",ne,T(k.value),1)]),s.value?(y(),S(J,{key:0,switches:L.value,currentIndex:l.value,smallFont:!0,onSwitch:C,style:{"z-index":"200"}},null,8,["switches","currentIndex"])):g("",!0),r("div",oe," isTop250: "+T(s.value)+", rankType: "+T(k.value),1),I(K,{data:m.value,pullup:!0,probeType:3,listenScroll:!0,onScrollToEnd:P,onScroll:b,class:"rank-list-wrapper",ref_key:"scrollRef",ref:u},{default:z(()=>[r("div",{class:$(["rank-content",{"more-padding":s.value}])},[I(X,{rankItems:m.value,hasMore:p.value,onSelect:O},null,8,["rankItems","hasMore"])],2),m.value.length?g("",!0):(y(),S(Q,{key:0,fullScreen:!0}))]),_:1},8,["data"])]))}},me=H(le,[["__scopeId","data-v-69294394"]]);export{me as default};
