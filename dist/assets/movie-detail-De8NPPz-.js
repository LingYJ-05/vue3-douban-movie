import{_ as M,r as t,H as P,y as Y,n as $,c as d,o as p,a,f as r,b as _,e as y,v as f,P as j,t as q,j as F,q as O,u as Q,Q as U,x as W,R as z,L as G,A as J}from"./index-DLCzzkkd.js";import{S as K}from"./switches-BRLQLFHU.js";const X={class:"detail-wrapper"},Z={class:"fixed-title"},ee={class:"icon"},te=["textContent"],se={class:"scroll-wrapper"},ae={key:0,class:"scroll-centent"},oe=["src"],le={class:"switch"},re={__name:"movie-detail",setup(ne){const l=Q(),i=Y(),R=W(),u=t(null),k=t(null),h=t(null),o=t(null),I=t(!0),v=t(0),E=t(-1),m=t(-1),n=t(!1),T=[{name:çŸ­è¯„},{name:å½±è¯„}],w=t(3),g=t(!0),c=P(()=>i.getters.movie),b=()=>{l.back()},C=e=>{v.value=e,J(()=>{var s;(s=u.value)==null||s.refresh()})},D=e=>e!==void 0?"https://images.weserv.nl/?url="+e.replace(/http\w{0,1}:\/\//,""):"",N=e=>{console.log("å›¾ç‰‡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å ä½å›¾:",e.target.src),e.target.src="https://via.placeholder.com/300x450?text=ç”µå½±æµ·æŠ¥"},S=e=>{E.value=e.y,-m.value>e.y&&m!==-1?n.value=!0:n.value=!1},V=async()=>{if(!c.value.id){l.push("/movie-show");return}try{const e=await U(c.value.id);if(!R.params.movieId)return;o.value=e,setTimeout(()=>{var s;l.params.movieId&&(m.value=H(),(s=u.value)==null||s.refresh())},100)}catch(e){console.error("èŽ·å–ç”µå½±è¯¦æƒ…å¤±è´¥",e)}},H=()=>{var e;return((e=h.value)==null?void 0:e.clientHeight)||0},A=()=>{i.commit("SET_DISCUSSION_TYPE","comment"),l.push({path:`/movie-detail/${c.value.id}/reviews`})},B=e=>{i.commit("SET_SELECTED_REVIEW",e),l.push({path:`/movie-detail/${c.value.id}/reviews`})};return $(()=>{w.value=3,g.value=!0,V()}),(e,s)=>{const L=O("router-view");return p(),d("div",X,[a("div",Z,[a("span",{class:"back",onClick:b},[...s[0]||(s[0]=[a("i",{class:"icon-back"},"â†",-1)])]),a("span",{class:"type",ref_key:"fixedRef",ref:k},[_(a("span",ee,[...s[1]||(s[1]=[a("i",{class:"icon-video-camera"},"ðŸŽ¥",-1),j(" ç”µå½± ",-1)])],512),[[f,!n.value]]),n.value?(p(),d("span",{key:0,class:"movie-name",textContent:q(o.value.title)},null,8,te)):y("",!0)],512)]),r(S,{class:"movie-detail",data:o.value,probeType:w.value,listenScroll:g.value,onScroll:S,ref_key:"scrollRef",ref:u},{default:F(()=>{var x;return[a("div",se,[o.value.images?(p(),d("div",ae,[a("div",{class:"bg-image",ref_key:"imageRef",ref:h},[a("img",{src:D((x=o.value.images)==null?void 0:x.large),onError:N},null,40,oe)],512),a("div",le,[r(K,{switch:T,currentIndex:v.value,onSwitches:C},null,8,["currentIndex"])]),_(r(z,{review:o.value.popular_review.slice(0,5),reviewNum:o.value.review._count,onSelectReview:B,onNeedAllReview:A},null,8,["review","reviewNum"]),[[f,v.value===0]])])):y("",!0)]),_(r(G,{fullScreen:I.value},null,8,["fullScreen"]),[[f,!o.value.images]])]}),_:1},8,["data","probeType","listenScroll"]),r(L)])}}},ue=M(re,[["__scopeId","data-v-72525984"]]);export{ue as default};
