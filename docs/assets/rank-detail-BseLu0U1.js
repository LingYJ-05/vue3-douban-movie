import{r as a,D as $,j as A,a as y,o as v,e as r,i as _,b as S,t as H,F as Y,d as q,z as G,p as J,u as K,w as P,v as Q,m as U,n as W,g as X,k as Z}from"./vue-BX9jk9wQ.js";import{_ as x,S as ee,c as f,L as ae,b as se}from"./movie-components-DMAopocz.js";import{R as T}from"./rank-list-HpBP04Dh.js";import{u as le,n as te,w as oe,t as ne}from"./movie-rank-D7qcHrz3.js";import"./vendor-ngrFHoWO.js";const ue={class:"rank-wrapper"},re={class:"fixed-title"},ce={class:"type"},m=10,ve={__name:"rank-detail",setup(pe){const g=G(),d=J(),R=K(),t=a(""),o=a(null),n=a(0),M=a(!0),I=a(!0),E=a(3),F=a(!0),h=a([{name:"1-50"},{name:"51-100"},{name:"101-150"},{name:"151-200"},{name:"201-250"}]),L=a(!0),p=a([0,50,100,150,200]),b=a([0,0,0,0,0]),l=a({}),c=a([!1,!1,!1,!1,!1]),i=a(!0),k=a(null),j=()=>{d.back("/rank")},B=e=>{b.value[n.value]=e.y},C=e=>{n.value=e,i.value=!0,Z(()=>{k.value&&k.value.length>0&&k.value.forEach(s=>{s.scrollTo(0,b.value[e]),setTimeout(()=>{s.refresh()},20)}),(!l.value[e]||l.value[e]&&l.value[e].length===0)&&(c.value[e]=!0,o.value(p.value[e],m).then(s=>{l.value[e]=f(s.subjects)}))})},D=e=>{d.push(`/movie/${e.id}`),R.commit("SET_MOVIE",e)},V=()=>{const e=n.value;i.value&&(i.value=!1,c.value[e]&&(p.value[e]+=m,o.value(p.value[e],m).then(s=>{l.value[e]=l.value[e].concat(f(s.subjects)),N(s),i.value=!0})))},N=e=>{const s=e.subjects,w=50*(n.value+1);(!s.length||e.start+e.count>=w)&&(c.value[n.value]=!1)},z=()=>{switch(g.params.rankType){case"top250":o.value=ne,t.value="豆瓣 Top250";break;case"weekly":o.value=oe,t.value="本周口碑榜";break;case"new":o.value=te,t.value="新片榜";break;case"us":o.value=le,t.value="北美票房榜";break}},O=()=>{t.value!=="豆瓣 Top250"?o.value().then(e=>{l.value[0]=f(e.subjects)}):o.value(p.value[0],m).then(e=>{l.value[0]=f(e.subjects),c.value[0]=!0})};return $(()=>{for(let e=0;e<h.value.length;e++)l.value[e]=[]}),A(()=>{z(),O()}),(e,s)=>(v(),y("div",ue,[r("div",re,[r("span",{class:"back",onClick:j},[...s[0]||(s[0]=[r("i",{class:"icon-back"},"←",-1)])]),r("span",ce,[r("span",null,H(t.value),1)])]),t.value==="豆瓣 Top250"?(v(),_(ee,{key:0,switches:h.value,currentIndex:n.value,smallFont:L.value,onSwitch:C},null,8,["switches","currentIndex","smallFont"])):S("",!0),(v(!0),y(Y,null,q(h.value,(w,u)=>P((v(),_(se,{data:T[u],pullup:I.value,key:u,probeType:E.value,listenScroll:F.value,onScrollToEnd:V,onScroll:B,class:"rank-list-wrapper",ref_for:!0,ref_key:"scrollRef",ref:k},{default:U(()=>[r("div",{class:W(["rank-content",{"more-padding":t.value==="豆瓣 Top250"}])},[X(T,{rankItems:l.value[u],hasMore:c.value,page:u,onSelect:D},null,8,["rankItems","hasMore","page"])],2),l.value[u].length?S("",!0):(v(),_(ae,{key:0,fullScreen:M.value},null,8,["fullScreen"]))]),_:2},1032,["data","pullup","probeType","listenScroll"])),[[Q,n.value===u]])),128))]))}},_e=x(ve,[["__scopeId","data-v-a2b76df4"]]);export{_e as default};
